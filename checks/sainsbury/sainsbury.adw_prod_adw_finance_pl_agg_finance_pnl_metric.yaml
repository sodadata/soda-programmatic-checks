checks for adw_prod_adw_finance_pl_agg_finance_pnl_metric:

  - schema:
      name: Any schema changes
      warn:
        when schema changes:
          - column delete
          - column add
          - column index change
          - column type change

  - row_count > 0

  - missing_count(deal_correction_other_amt) = 0
  - missing_count(third_party_points_revenue_amt) = 0
  - missing_count(nectar_third_party_points_income_amt) = 0
  - missing_count(nectar_third_party_points_cos_amt) = 0
  - missing_count(net_retail_sales_vat_amt) = 0
  - missing_count(cost_of_sale_amt) = 0
  - missing_count(finance_services_cos_amt) = 0
  - missing_count(user_credits_amt) = 0
  - missing_count(repayment_of_supplier_claims_amt) = 0
  - missing_count(food_b2b_logistics_unit_cost_amt) = 0
  - missing_count(fuel_unit_cost_adjustment_amt) = 0
  - missing_count(cdn_overcharge_reversals_amt) = 0
  - missing_count(delivery_price_variances_grns_amt) = 0
  - missing_count(ad_delivery_variance_amt) = 0
  - missing_count(di_eros_mpv_amt) = 0
  - missing_count(merchandise_price_variances_trading_amt) = 0
  - missing_count(unit_cost_adjustments_amt) = 0
  - missing_count(buying_margin_amt) = 0
  - missing_count(promotional_events_funding_amt) = 0
  - missing_count(marketing_events_funding_amt) = 0
  - missing_count(operational_activity_funding_amt) = 0
  - missing_count(deal_corrections_promo_amt) = 0
  - missing_count(promotional_marketing_events_funding_amt) = 0
  - missing_count(scale_benefits_purchasing_event_amt) = 0
  - missing_count(deal_corrections_volume_amt) = 0
  - missing_count(scale_benefits_funding_amt) = 0
  - missing_count(compliance_charges_amt) = 0
  - missing_count(other_supplier_income_amt) = 0
  - missing_count(other_supplier_income_total_amt) = 0
  - missing_count(supplier_income_amt) = 0
  - missing_count(debit_note_reversals_amt) = 0
  - missing_count(ssp_product_gross_margin_adjustment_amt) = 0
  - missing_count(sampling_costs_amt) = 0
  - missing_count(freight_charge_adjustments_amt) = 0
  - missing_count(cost_sales_adj_amt) = 0
  - missing_count(cos_adj_prior_period_adj_amt) = 0
  - missing_count(forced_throughs_amt) = 0
  - missing_count(cost_of_sales_system_corrections_amt) = 0
  - missing_count(package_compliance_costs_amt) = 0
  - missing_count(distinctive_brands_amt) = 0
  - missing_count(exceptional_cost_of_sale_adjustments_amt) = 0
  - missing_count(fuel_gross_margin_adjustments_amt) = 0
  - missing_count(missing_misc_adjustments_amt) = 0
  - missing_count(sainsburys_prepaid_amt) = 0
  - missing_count(refurbs_amt) = 0
  - missing_count(inventory_adjustments_amt) = 0
  - missing_count(depot_stock_adjustments_amt) = 0
  - missing_count(product_withdrawal_amt) = 0
  - missing_count(hangers_cost_rebate_amt) = 0
  - missing_count(packaging_clothing_amt) = 0
  - missing_count(cancelled_supplier_orders_amt) = 0
  - missing_count(demurrage_amt) = 0
  - missing_count(charity_donation_adjustment_amt) = 0
  - missing_count(volumetric_royalties_amt) = 0
  - missing_count(net_realisable_value_provisions_amt) = 0
  - missing_count(slow_moving_stock_provision_amt) = 0
  - missing_count(obsolesence_provision_amt) = 0
  - missing_count(damaged_goods_provision_amt) = 0
  - missing_count(other_stock_provisions_amt) = 0
  - missing_count(stock_provisions_amt) = 0
  - missing_count(other_provisions_amt) = 0
  - missing_count(adhoc_cost_adjustments_amt) = 0
  - missing_count(other_cos_amt) = 0
  - missing_count(freight_and_duty_amt) = 0
  - missing_count(reworks_clearance_amt) = 0
  - missing_count(breakage_clearance_amt) = 0
  - missing_count(ro_clearance_amt) = 0
  - missing_count(returns_write_off_costs_amt) = 0
  - missing_count(merchandise_price_variance_other_amt) = 0
  - missing_count(isos_amt) = 0
  - missing_count(polling_failure_amt) = 0
  - missing_count(reinstates_amt) = 0
  - missing_count(revaluation_amt) = 0
  - missing_count(undelivered_cos_amt) = 0
  - missing_count(waste_electrical_electronic_equipment_recycling_amt) = 0
  - missing_count(margin_intercompany_costs_amt) = 0
  - missing_count(gross_profit_adjustments_amt) = 0
  - missing_count(gross_profit_amt) = 0
  - missing_count(sales_exclusion_ind) = 0
  - missing_count(polled_week_num) = 0
  - missing_count(tran_week_num) = 0
  - missing_count(item_cd) = 0
  - missing_count(sub_cat_cd) = 0
  - missing_count(sales_initiated_location_cd) = 0
  - missing_count(dispatch_location_cd) = 0
  - missing_count(replen_location_cd) = 0
  - missing_count(sales_origination_channel_cd) = 0
  - missing_count(fulfilment_channel_cd) = 0
  - missing_count(operating_company_cd) = 0
  - missing_count(gross_sales_volume) = 0
  - missing_count(return_sales_volume) = 0
  - missing_count(net_sales_volume) = 0
  - missing_count(prepromotions_services_sales_amt) = 0
  - missing_count(prepromotions_product_sales_amt) = 0
  - missing_count(total_prepromotions_sales_amt) = 0
  - missing_count(promotional_discount_amt) = 0
  - missing_count(central_markdown_discount_amt) = 0
  - missing_count(store_markdown_discount_amt) = 0
  - missing_count(nectar_points_product_specific_amt) = 0
  - missing_count(marketing_discounts_product_level_amt) = 0
  - missing_count(return_retail_value_amt) = 0
  - missing_count(gross_sales_after_product_discount_amt) = 0
  - missing_count(other_corporate_vouchers_amt) = 0
  - missing_count(marketing_discounts_basket_level_amt) = 0
  - missing_count(nectar_points_basket_level_amt) = 0
  - missing_count(commissions_concessions_jobbing_recovery_amt) = 0
  - missing_count(other_sales_adjustments_amt) = 0
  - missing_count(colleague_discount_amt) = 0
  - missing_count(corporate_sales_adjustments_amt) = 0
  - missing_count(net_retail_sales_amt) = 0
  - missing_count(financial_services_revenue_amt) = 0
  - missing_count(points_billings_amt) = 0
  - missing_count(deferral_points_billings_amt) = 0
  - missing_count(non_points_revenue_third_party_amt) = 0
  - missing_count(polled_dt) = 0
  - missing_count(tran_dt) = 0
  - missing_count(load_ts) = 0
